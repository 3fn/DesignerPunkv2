/**
 * Avatar Component Styles for Web Platform
 * 
 * Token-based styling using CSS custom properties from the mathematical token system.
 * All values reference semantic, primitive, or component tokens - zero hard-coded values.
 * 
 * Stemma System Naming: [Family]-[Type] = Avatar
 * Component Type: Primitive (Base)
 * 
 * @module Avatar/platforms/web/styles
 * @see .kiro/specs/042-avatar-component/design.md for styling details
 * @see .kiro/specs/042-avatar-component/requirements.md for requirements
 */

/* ==========================================================================
   Base Avatar Styles
   ========================================================================== */

/**
 * Base avatar element styling.
 * 
 * - Flexbox layout for centering icon/image content
 * - Token-based sizing, colors, and borders
 * - Box-sizing for predictable dimensions
 * - Overflow hidden for image clipping
 */
.avatar {
  /* Layout */
  display: flex;
  align-items: center;
  justify-content: center;
  
  /* Box model */
  box-sizing: border-box;
  overflow: hidden;
  
  /* Ensure avatar doesn't shrink in flex containers */
  flex-shrink: 0;
}

/* ==========================================================================
   Shape Variants
   ========================================================================== */

/**
 * Human avatar shape (circle).
 * 
 * - Perfect circle via radiusHalf token (50%)
 * - Represents organic, natural human users
 * - Clips images to circular shape
 * 
 * @see Requirements: 1.1 - Human type renders as perfect circle
 */
.avatar--human {
  /* Use radiusHalf token for perfect circle - explicitly designed for avatars */
  border-radius: var(--radius-half);
}

/**
 * Agent avatar shape (hexagon).
 * 
 * Uses SVG clipPath for rounded hexagon with pointy-top orientation.
 * The aspect-ratio ensures the hexagon maintains its mathematical
 * proportions: width = height × cos(30°) ≈ 0.866
 * 
 * - Represents synthetic, constructed AI agents
 * - Pointy-top orientation for dynamic, crystalline feel
 * - Rounded corners via Ana Tudor technique (SVG clipPath)
 * 
 * @see Requirements: 1.2, 1.3, 1.4 - Hexagon shape with correct aspect ratio
 * @see Requirements: 11.1, 11.2, 11.3, 11.4 - SVG clipPath implementation
 */
.avatar--agent {
  /* Hexagon aspect ratio: cos(30°) ≈ 0.866 (width = height × 0.866) */
  aspect-ratio: 0.866;
  
  /* SVG clipPath for rounded hexagon shape */
  clip-path: url(#rounded-hexagon);
}

/* ==========================================================================
   Size Variants
   ========================================================================== */

/**
 * Size variants using component tokens.
 * 
 * All sizes reference avatar component tokens which in turn reference
 * spacing tokens or calculated values from the mathematical foundation.
 * 
 * For agent type (hexagon), height is set and width is derived from aspect-ratio.
 * For human type (circle), both width and height must be set explicitly.
 * 
 * Token Relationships:
 * - xs: avatar.size.xs → space300 (24px)
 * - sm: avatar.size.sm → space400 (32px)
 * - md: avatar.size.md → space500 (40px)
 * - lg: avatar.size.lg → space600 (48px)
 * - xl: avatar.size.xl → SPACING_BASE_VALUE × 10 (80px)
 * - xxl: avatar.size.xxl → SPACING_BASE_VALUE × 16 (128px)
 * 
 * @see Requirements: 2.1-2.6 - Size variants using component tokens
 */

/**
 * Extra small avatar (24px).
 * 
 * For inline mentions and compact UI contexts where minimal visual footprint is needed.
 * 
 * @see Requirements: 2.1 - xs size using avatar.size.xs token
 */
.avatar--size-xs {
  height: var(--avatar-size-xs);
}

/* Human type needs explicit width since it doesn't use aspect-ratio */
.avatar--human.avatar--size-xs {
  width: var(--avatar-size-xs);
}

/**
 * Small avatar (32px).
 * 
 * For list items and secondary UI contexts with moderate visual presence.
 * 
 * @see Requirements: 2.2 - sm size using avatar.size.sm token
 */
.avatar--size-sm {
  height: var(--avatar-size-sm);
}

.avatar--human.avatar--size-sm {
  width: var(--avatar-size-sm);
}

/**
 * Medium avatar (40px) - Default size.
 * 
 * Provides balanced visual weight for most UI contexts.
 * 
 * @see Requirements: 2.3 - md size using avatar.size.md token
 * @see Requirements: 2.7 - Default to "md" size when prop omitted
 */
.avatar--size-md {
  height: var(--avatar-size-md);
}

.avatar--human.avatar--size-md {
  width: var(--avatar-size-md);
}

/**
 * Large avatar (48px).
 * 
 * For profile headers and primary UI contexts requiring prominent visual presence.
 * 
 * @see Requirements: 2.4 - lg size using avatar.size.lg token
 */
.avatar--size-lg {
  height: var(--avatar-size-lg);
}

.avatar--human.avatar--size-lg {
  width: var(--avatar-size-lg);
}

/**
 * Extra large avatar (80px).
 * 
 * For profile pages and hero sections where avatar is a focal point.
 * 
 * @see Requirements: 2.5 - xl size using avatar.size.xl token
 */
.avatar--size-xl {
  height: calc(var(--avatar-size-xl) * 1px);
}

.avatar--human.avatar--size-xl {
  width: calc(var(--avatar-size-xl) * 1px);
}

/**
 * Extra extra large avatar (128px).
 * 
 * For hero profiles and full-page profile views requiring maximum visual impact.
 * 
 * @see Requirements: 2.6 - xxl size using avatar.size.xxl token
 */
.avatar--size-xxl {
  height: calc(var(--avatar-size-xxl) * 1px);
}

.avatar--human.avatar--size-xxl {
  width: calc(var(--avatar-size-xxl) * 1px);
}

/* ==========================================================================
   Background Colors
   ========================================================================== */

/**
 * Background colors for avatar types.
 * 
 * Uses semantic color tokens for avatar backgrounds.
 * Background is hidden when an image is displayed.
 * 
 * @see Requirements: 4.1, 4.2 - Background colors per type
 */

/**
 * Human avatar background (orange).
 * 
 * @see Requirements: 4.1 - Human type uses color.avatar.human token
 */
.avatar--human {
  background-color: var(--color-avatar-human);
}

/**
 * Agent avatar background (teal).
 * 
 * @see Requirements: 4.2 - Agent type uses color.avatar.agent token
 */
.avatar--agent {
  background-color: var(--color-avatar-agent);
}

/* ==========================================================================
   Border Styles
   ========================================================================== */

/**
 * Border styles for avatars.
 * 
 * Borders provide visual definition and scale appropriately for hero sizes.
 * 
 * Size Range xs-xl:
 * - Border width: borderDefault (1px)
 * - Border color: color.avatar.border with opacity.heavy (48%)
 * 
 * Size xxl:
 * - Border width: borderEmphasis (2px)
 * - Border color: color.contrast.onSurface with full opacity
 * 
 * Note: Border opacity is applied using color-mix() to blend the border color
 * with transparent, achieving the opacity effect without affecting the entire element.
 * 
 * @see Requirements: 7.1, 7.2, 7.3, 7.4 - Border styles per size
 */

/**
 * Default border for xs through xl sizes.
 * 
 * Uses borderDefault width with color.avatar.border at opacity.heavy (48%).
 * Since opacity tokens are decimal values (0.48), we use a fallback approach
 * with a hardcoded percentage that matches the opacity.heavy token value.
 * 
 * @see Requirements: 7.1, 7.2 - xs-xl border styles
 */
.avatar {
  border-width: var(--border-default);
  border-style: solid;
  /* Apply opacity.heavy (48%) to border color using color-mix
   * Note: opacity.heavy = 0.48, so we use 48% directly since color-mix
   * doesn't support calc() with decimal-to-percentage conversion */
  border-color: color-mix(in srgb, var(--color-avatar-border) 48%, transparent);
}

/**
 * Enhanced border for xxl size.
 * 
 * Uses borderEmphasis width with white100 at full opacity.
 * 
 * @see Requirements: 7.3, 7.4 - xxl border styles
 * @see design-outline.md - Border Styles section specifies white100 for xxl
 */
.avatar--size-xxl {
  border-width: var(--border-emphasis);
  border-color: var(--white-100);
}

/* ==========================================================================
   Interactive State
   ========================================================================== */

/**
 * Interactive avatar hover state.
 * 
 * When interactive prop is true, avatar shows visual feedback on hover
 * by increasing border width from borderDefault to borderEmphasis.
 * 
 * Uses motion.focusTransition semantic token (150ms, standard easing) for
 * fast, responsive transition. This semantic token is appropriate for
 * interactive state transitions and matches the design requirement for
 * motion.duration.fast.
 * 
 * @see Requirements: 8.1, 8.2, 8.3, 8.4 - Interactive hover state
 */
.avatar--interactive {
  cursor: pointer;
  transition: border-width var(--motion-focus-transition-duration) var(--motion-focus-transition-easing);
}

/**
 * Hover state for interactive avatars.
 * 
 * Increases border width to borderEmphasis for visual feedback.
 * 
 * @see Requirements: 8.1 - Hover increases border width
 */
.avatar--interactive:hover {
  border-width: var(--border-emphasis);
}

/* ==========================================================================
   Reduced Motion Support
   ========================================================================== */

/**
 * Respect user preference for reduced motion.
 * 
 * - Remove transitions and animations
 * - Maintain functionality without motion
 */
@media (prefers-reduced-motion: reduce) {
  .avatar--interactive {
    transition: none;
  }
}

/* ==========================================================================
   High Contrast Mode Support
   ========================================================================== */

/**
 * Ensure avatars remain visible in Windows High Contrast Mode.
 * 
 * - Force borders for all avatar types
 * - Ensure focus indicators are visible when in interactive wrapper
 */
@media (prefers-contrast: high) {
  .avatar {
    border: var(--border-emphasis) solid currentColor;
  }
}

/* ==========================================================================
   Icon Content Styles
   ========================================================================== */

/**
 * Icon container within avatar.
 * 
 * Centers the icon within the avatar and applies appropriate sizing.
 * Icon color is set based on avatar type for proper contrast.
 * 
 * @see Requirements: 3.1-3.8 - Icon content and sizing
 * @see Requirements: 6.1, 6.2 - Icon colors for contrast
 */
.avatar__icon {
  /* Layout */
  display: flex;
  align-items: center;
  justify-content: center;
  
  /* Ensure icon doesn't overflow avatar bounds */
  flex-shrink: 0;
  
  /* Line height reset for proper vertical centering */
  line-height: 0;
}

/**
 * Icon color for human avatar type.
 * 
 * Uses color.avatar.contrast.onHuman semantic token for proper contrast
 * against the orange background.
 * 
 * @see Requirements: 6.1 - Human type icon uses color.avatar.contrast.onHuman
 */
.avatar__icon--human {
  color: var(--color-avatar-contrast-on-human);
}

/**
 * Icon color for agent avatar type.
 * 
 * Uses color.avatar.contrast.onAgent semantic token for proper contrast
 * against the teal background.
 * 
 * @see Requirements: 6.2 - Agent type icon uses color.avatar.contrast.onAgent
 */
.avatar__icon--agent {
  color: var(--color-avatar-contrast-on-agent);
}

/**
 * SVG icon styling for custom-sized icons (xs and xxl).
 * 
 * Ensures SVG fills its container and inherits color from parent.
 */
.avatar__icon-svg {
  width: 100%;
  height: 100%;
  display: block;
}

/**
 * Icon-Base component styling within avatar.
 * 
 * Ensures the Icon-Base component inherits color from the avatar__icon container.
 * The Icon-Base uses currentColor for stroke, so setting color on the container
 * propagates to the icon.
 */
.avatar__icon .icon-base {
  color: inherit;
}

/* ==========================================================================
   Image Content Styles
   ========================================================================== */

/**
 * Image content within avatar.
 * 
 * Displays profile images for human avatars. Images are:
 * - Scaled to cover the entire avatar area (object-fit: cover)
 * - Clipped to circle shape via parent border-radius
 * - Full width/height to fill avatar container
 * 
 * @see Requirements: 5.1, 5.2, 5.3 - Image display and scaling
 */
.avatar__image {
  /* Fill the entire avatar container */
  width: 100%;
  height: 100%;
  
  /* Scale image to cover container while maintaining aspect ratio */
  /* @see Requirements: 5.2 - Use object-fit: cover for image scaling */
  object-fit: cover;
  
  /* Ensure image doesn't overflow avatar bounds */
  display: block;
}

/**
 * Avatar with image - hide background color.
 * 
 * When an image is displayed, the background color should be hidden
 * so the image is fully visible.
 * 
 * @see Requirements: 4.3 - Hide background when image is displayed
 */
.avatar--has-image {
  background-color: transparent;
}
