# Chip-Base Component Schema
#
# Stemma System: Chip Family
# Component Type: Primitive (Base)
# Naming Convention: [Family]-[Type] = Chip-Base
#
# This schema defines the behavioral contracts and properties for the
# Chip-Base component, which serves as the foundational primitive
# for all chip components in the Chip family.
#
# Rationale: Chip-Base is a primitive component that provides compact,
# interactive elements for filtering, selection, or input management.
# It serves as the building block for semantic chip variants (Chip-Filter,
# Chip-Input) by providing consistent sizing, styling, and interaction patterns.
#
# DesignerPunk Philosophy: NO DISABLED STATES
# This component does not support disabled states. If an action is unavailable,
# the component should not be rendered. This ensures users always see actionable
# UI elements.

name: Chip-Base
type: primitive
family: Chip
version: "1.0.0"
readiness: production-ready

# Component description
description: |
  Foundational chip component providing compact, interactive elements for
  filtering, selection, or input management. Serves as the primitive base
  for all chip components in the Chip family.
  
  Key Characteristics:
  - Compact: 32px visual height with 48px tap area for accessibility
  - Interactive: Responds to press/click/tap events
  - Pill-shaped: Uses radius.full for rounded appearance
  - Token-first: All styling via design tokens, no hard-coded values
  
  Chip-Base supports optional leading icons via Icon-Base at icon.size075,
  consistent state styling (default, hover, pressed), and full keyboard
  accessibility.
  
  DesignerPunk Philosophy: NO DISABLED STATES
  If an action is unavailable, the component should not be rendered.

# Reusable behaviors this component implements
behaviors:
  - renderable
  - pressable
  - focusable
  - accessible

# Component properties (public API)
properties:
  label:
    type: string
    required: true
    description: |
      Chip text content (required). The label text to display inside the chip.
      Text uses typography.buttonSm token for consistent styling.
  
  icon:
    type: IconName
    required: false
    description: |
      Optional leading icon. When provided, renders an icon before the label
      text using Icon-Base at icon.size075 (20px). Icon and label are separated
      by space.grouped.tight (4px) gap.
  
  onPress:
    type: "() => void"
    required: false
    description: |
      Called when chip is pressed. Invoked on:
      - Mouse click (web)
      - Touch tap (all platforms)
      - Keyboard Enter or Space (web)
      When not provided, chip is display-only but still focusable.
  
  testID:
    type: string
    required: false
    description: |
      Test identifier for automated testing. Platform-specific implementation:
      - Web: data-testid attribute
      - iOS: accessibilityIdentifier
      - Android: testTag

# Behavioral contracts - guarantees this component provides
contracts:
  renders_pill_container:
    description: Renders pill-shaped container with label text
    behavior: |
      Chip-Base renders a pill-shaped container using radius.full token.
      The container displays the label text using typography.buttonSm.
      Visual height is 32px (derived from padding + content).
      Container has 1px border using borderDefault token.
    wcag: null
    platforms: [web, ios, android]
    validation: |
      - Container renders with pill shape (radius.full)
      - Label text is visible and uses typography.buttonSm
      - Visual height is 32px
      - Border width is 1px (borderDefault)
  
  renders_icon:
    description: Renders optional leading icon using Icon-Base
    behavior: |
      When icon prop is provided, Chip-Base renders an Icon-Base component
      before the label text at icon.size075 (20px). Icon and label are
      separated by space.grouped.tight (4px) gap. Icon inherits color
      from chip text color via currentColor.
    wcag: null
    platforms: [web, ios, android]
    validation: |
      - Icon renders when icon prop provided
      - Icon size is 20px (icon.size075)
      - Gap between icon and label is 4px (space.grouped.tight)
      - Icon color matches text color
      - No icon renders when icon prop is undefined
  
  press_interaction:
    description: Responds to press/click/tap events
    behavior: |
      Chip-Base responds to user interaction by calling the onPress callback.
      Supported interactions:
      - Mouse click (web)
      - Touch tap (all platforms)
      - Keyboard Enter key (web)
      - Keyboard Space key (web)
      When onPress is not provided, chip is display-only.
    wcag: "2.1.1 Keyboard"
    platforms: [web, ios, android]
    validation: |
      - Click/tap triggers onPress callback
      - Enter key triggers onPress callback (web)
      - Space key triggers onPress callback (web)
      - No action when onPress is undefined
  
  state_styling:
    description: Visual feedback for interaction states
    behavior: |
      Chip-Base provides visual feedback for interaction states:
      - Default: surface background, border color, default text
      - Hover (web): blend.hoverDarker on background, primary border
      - Pressed: blend.pressedDarker on background, primary border
      State transitions use motion.duration.fast for smooth animation.
    wcag: "1.4.13 Content on Hover or Focus"
    platforms: [web, ios, android]
    validation: |
      - Default state uses color.structure.surface background
      - Hover state darkens background by blend.hoverDarker
      - Pressed state darkens background by blend.pressedDarker
      - Border changes to color.action.primary on hover/press
      - Transitions animate with motion.duration.fast
  
  keyboard_focusable:
    description: Can receive keyboard focus
    behavior: |
      Chip-Base can receive focus via Tab key navigation.
      Focus state is visually indicated with a focus ring using
      accessibility tokens. Focus ring appears on keyboard focus only
      (not mouse focus) via :focus-visible (web).
    wcag: "2.1.1 Keyboard, 2.4.7 Focus Visible"
    platforms: [web, ios, android]
    validation: |
      - Tab key moves focus to chip
      - Focus ring visible on keyboard focus
      - Focus ring uses accessibility tokens
      - Focus ring not shown on mouse click (web)
  
  keyboard_activation:
    description: Activates on Space/Enter key press
    behavior: |
      When focused, Chip-Base activates (calls onPress) when user presses
      Space or Enter key. This provides keyboard equivalence to mouse click
      and touch tap interactions.
    wcag: "2.1.1 Keyboard"
    platforms: [web]
    validation: |
      - Space key triggers onPress when focused
      - Enter key triggers onPress when focused
      - Key events prevented from bubbling after activation
  
  expanded_tap_area:
    description: 48px tap area for accessibility
    behavior: |
      Chip-Base provides a 48px tap area (tapAreaRecommended) despite the
      32px visual height. This is achieved via:
      - Web: ::before pseudo-element with negative inset
      - iOS: frame modifier with minHeight
      - Android: Modifier.sizeIn with minHeight
      This exceeds WCAG 2.5.5 minimum of 44px.
    wcag: "2.5.5 Target Size"
    platforms: [web, ios, android]
    validation: |
      - Tap area is 48px minimum
      - Visual appearance remains 32px height
      - Tap area is centered on visual element
  
  accessibility_role:
    description: Announces as button to assistive technology
    behavior: |
      Chip-Base announces as a button to assistive technology:
      - Web: role="button" attribute
      - iOS: Button accessibility trait
      - Android: Button semantics
      Label text is used as accessible name.
    wcag: "4.1.2 Name, Role, Value"
    platforms: [web, ios, android]
    validation: |
      - Screen readers announce as button
      - Label text is accessible name
      - Role is correctly communicated

# Design tokens this component requires
tokens:
  component:
    - chip.paddingBlock
  typography:
    - typography.buttonSm
  color:
    - color.structure.surface
    - color.structure.border
    - color.text.default
    - color.action.primary
  spacing:
    - space.inset.150
    - space.grouped.tight
  border:
    - borderDefault
    - radius.full
  motion:
    - motion.duration.fast
  blend:
    - blend.hoverDarker
    - blend.pressedDarker
  accessibility:
    - tapAreaRecommended
    - accessibility.focus.width
    - accessibility.focus.offset
    - accessibility.focus.color
  icon:
    - icon.size075

# Supported platforms
platforms:
  - web
  - ios
  - android

# Platform-specific implementation notes
platform_notes:
  web:
    element: "<chip-base>"
    implementation: Web Component with Shadow DOM
    file: platforms/web/ChipBase.web.ts
    notes: |
      - Uses Shadow DOM for style encapsulation
      - CSS custom properties for token consumption
      - role="button" and tabindex="0" for accessibility
      - ::before pseudo-element for expanded tap area
      - :focus-visible for keyboard-only focus indication
      - Logical properties (padding-block, padding-inline) for RTL support
  ios:
    implementation: SwiftUI View
    file: platforms/ios/ChipBase.swift
    notes: |
      - Uses SwiftUI Button with custom styling
      - Token consumption via DesignTokens constants
      - Capsule shape for pill appearance
      - frame(minHeight:) for 48px tap area
      - accessibilityIdentifier for testID
  android:
    implementation: Jetpack Compose Composable
    file: platforms/android/ChipBase.android.kt
    notes: |
      - Uses Compose Surface with onClick handler
      - Token consumption via DesignTokens object
      - RoundedCornerShape(50) for pill shape
      - Modifier.sizeIn(minHeight = 48.dp) for tap area
      - testTag for testID

# Semantic components that inherit from this primitive
semantic_variants:
  - name: Chip-Filter
    extends: Toggle chip with selected state for filtering content
    status: implemented
    inherits: Chip-Base
    additional_props:
      - selected (boolean)
      - onSelectionChange (callback)
    additional_behaviors:
      - Toggle selected state on press
      - Checkmark icon when selected (replaces leading icon)
      - aria-pressed for accessibility
  - name: Chip-Input
    extends: Dismissible chip for user-entered values like tags
    status: implemented
    inherits: Chip-Base
    additional_props:
      - onDismiss (callback)
    additional_behaviors:
      - Always shows X icon as trailing element
      - Tap anywhere dismisses (calls onDismiss)
      - Accessible label "Remove [label]" on X icon

# Accessibility compliance
accessibility:
  wcag_level: AA
  compliance:
    - "1.4.3 Contrast (Minimum) - Text meets 4.5:1 contrast ratio"
    - "1.4.11 Non-text Contrast - Border and focus ring meet 3:1 contrast"
    - "2.1.1 Keyboard - Fully keyboard accessible (Tab, Enter, Space)"
    - "2.4.7 Focus Visible - Clear focus indicator with :focus-visible"
    - "2.5.5 Target Size - 48px tap area exceeds 44px minimum"
    - "4.1.2 Name, Role, Value - Proper role and accessible name"
  aria_attributes:
    - role: button
    - tabindex: "0"
  keyboard_navigation:
    - Tab: Move focus to/from chip
    - Enter: Activate chip (call onPress)
    - Space: Activate chip (call onPress)
  platform_accessibility:
    web: "role='button', tabindex='0', :focus-visible for keyboard focus"
    ios: "Button accessibility trait, accessibilityIdentifier for testing"
    android: "Button semantics, testTag for testing"
