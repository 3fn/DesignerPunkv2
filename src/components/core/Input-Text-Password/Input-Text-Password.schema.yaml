# Input-Text-Password Component Schema
#
# Stemma System: Form Inputs Family
# Component Type: Semantic (inherits from Input-Text-Base)
# Naming Convention: [Family]-[Type]-[Variant] = Input-Text-Password
#
# This schema defines the behavioral contracts and properties for the
# Input-Text-Password component, which extends Input-Text-Base with
# secure input and password toggle functionality.

name: Input-Text-Password
type: semantic
family: FormInputs
inherits: Input-Text-Base
version: "1.0.0"
readiness: production-ready

# Component description
description: |
  Password input component extending Input-Text-Base with password-specific
  secure input and toggle functionality. Masks input by default and provides
  a toggle to show/hide the password. Supports password strength validation
  and autocomplete for current/new passwords.

# Reusable behaviors this component implements (inherited + extended)
behaviors:
  - focusable          # Inherited from Input-Text-Base
  - validatable        # Inherited from Input-Text-Base
  - float-label        # Inherited from Input-Text-Base
  - accessible         # Inherited from Input-Text-Base
  - secure-input       # Extended: Password masking
  - password-toggle    # Extended: Show/hide password
  - password-autocomplete # Extended: Password autofill support

# Component properties (extends Input-Text-Base)
properties:
  # Inherited from Input-Text-Base
  id:
    type: string
    required: true
    description: Unique identifier for the input element
  
  label:
    type: string
    required: true
    description: Label text (floats between placeholder and floated positions)
  
  value:
    type: string
    required: true
    description: Current input value
  
  onChange:
    type: "(value: string) => void"
    required: true
    description: Callback when value changes
  
  onFocus:
    type: "() => void"
    required: false
    description: Callback when input receives focus
  
  onBlur:
    type: "() => void"
    required: false
    description: Callback when input loses focus
  
  helperText:
    type: string
    required: false
    description: Helper text displayed below input (persistent)
  
  errorMessage:
    type: string
    required: false
    description: Error message from props (takes precedence over validation error)
  
  isSuccess:
    type: boolean
    required: false
    default: false
    description: Success state indicator (shows success icon)
  
  showInfoIcon:
    type: boolean
    required: false
    default: false
    description: Info icon support (shows info icon, triggers helper text)
  
  placeholder:
    type: string
    required: false
    description: Placeholder text (only shown when label is floated and input is empty)
  
  readOnly:
    type: boolean
    required: false
    default: false
    description: Read-only state (alternative to disabled)
  
  required:
    type: boolean
    required: false
    default: false
    description: Required field indicator
  
  maxLength:
    type: number
    required: false
    description: Maximum length for input value
  
  testID:
    type: string
    required: false
    description: Test ID for automated testing
  
  className:
    type: string
    required: false
    description: Additional CSS class names (web only)
  
  # Fixed properties for password input
  type:
    type: "'password' | 'text'"
    required: false
    default: "'password'"
    description: Input type toggles between 'password' (masked) and 'text' (visible)
  
  autocomplete:
    type: "'current-password' | 'new-password'"
    required: false
    default: "'current-password'"
    description: Autocomplete type for password autofill support
  
  # Password-specific properties
  showPassword:
    type: boolean
    required: false
    default: false
    description: Whether password is currently visible (controlled externally or internally)
  
  onToggleVisibility:
    type: "(visible: boolean) => void"
    required: false
    description: Callback when password visibility is toggled
  
  showToggle:
    type: boolean
    required: false
    default: true
    description: Whether to show the password visibility toggle button
  
  minLength:
    type: number
    required: false
    description: Minimum password length for validation
  
  requireUppercase:
    type: boolean
    required: false
    default: false
    description: Require at least one uppercase letter
  
  requireLowercase:
    type: boolean
    required: false
    default: false
    description: Require at least one lowercase letter
  
  requireNumber:
    type: boolean
    required: false
    default: false
    description: Require at least one number
  
  requireSpecialChar:
    type: boolean
    required: false
    default: false
    description: Require at least one special character
  
  customValidator:
    type: "(password: string) => boolean"
    required: false
    description: Custom password validation function (overrides default validation)
  
  invalidPasswordMessage:
    type: string
    required: false
    default: "'Password does not meet requirements'"
    description: Custom error message for invalid password
  
  onValidate:
    type: "(isValid: boolean, errorMessage?: string) => void"
    required: false
    description: Callback when validation occurs (on blur)
  
  isNewPassword:
    type: boolean
    required: false
    default: false
    description: Whether this is for a new password (affects autocomplete)

# Behavioral contracts - guarantees this component provides
# Inherits all 9 contracts from Input-Text-Base plus 3 password-specific contracts
contracts:
  # Inherited contracts from Input-Text-Base
  focusable:
    inherited: true
    description: Can receive keyboard focus
    wcag: "2.1.1 Keyboard"
    platforms: [web, ios, android]
  
  float_label_animation:
    inherited: true
    description: Label animates on focus
    wcag: "2.3.3 Animation from Interactions"
    platforms: [web, ios, android]
  
  validates_on_blur:
    inherited: true
    description: Validation triggers on blur
    wcag: "3.3.1 Error Identification"
    platforms: [web, ios, android]
  
  error_state_display:
    inherited: true
    description: Shows error message and styling
    wcag: "3.3.1 Error Identification, 1.4.1 Use of Color"
    platforms: [web, ios, android]
  
  success_state_display:
    inherited: true
    description: Shows success styling
    wcag: "1.4.1 Use of Color"
    platforms: [web, ios, android]
  
  disabled_state:
    inherited: true
    description: Prevents interaction when disabled
    wcag: "4.1.2 Name, Role, Value"
    platforms: [web, ios, android]
  
  trailing_icon_display:
    inherited: true
    description: Shows contextual trailing icons
    wcag: "1.4.1 Use of Color"
    platforms: [web, ios, android]
  
  focus_ring:
    inherited: true
    description: WCAG 2.4.7 focus visible indicator
    wcag: "2.4.7 Focus Visible"
    platforms: [web, ios, android]
  
  reduced_motion_support:
    inherited: true
    description: Respects prefers-reduced-motion
    wcag: "2.3.3 Animation from Interactions"
    platforms: [web, ios, android]
  
  # Password-specific contracts
  provides_secure_input:
    description: Masks password input by default
    behavior: |
      Password characters are masked (shown as dots or asterisks) by default.
      The actual password value is never exposed in the DOM or accessibility tree.
      Screen readers announce "password" input type for security awareness.
    wcag: "3.3.2 Labels or Instructions"
    platforms: [web, ios, android]
    validation: |
      - Input type is 'password' by default
      - Characters are visually masked
      - Value is not exposed in DOM attributes
      - Screen readers announce password input type
  
  supports_password_toggle:
    description: Provides show/hide password functionality
    behavior: |
      A toggle button allows users to show or hide the password.
      Toggle is keyboard accessible and properly labeled for screen readers.
      Toggle state is announced to assistive technologies.
      When visible, input type changes to 'text' to show characters.
    wcag: "2.1.1 Keyboard, 4.1.2 Name, Role, Value"
    platforms: [web, ios, android]
    validation: |
      - Toggle button is present when showToggle is true
      - Toggle is keyboard accessible (Enter/Space)
      - Toggle has accessible label ("Show password" / "Hide password")
      - Password visibility changes on toggle
      - State change is announced to screen readers
  
  provides_password_autocomplete:
    description: Enables browser/platform password autofill
    behavior: |
      Sets appropriate autocomplete/content type attributes to enable
      password suggestions from browser/platform autofill systems.
      - Web: autocomplete="current-password" or "new-password"
      - iOS: textContentType = .password or .newPassword
      - Android: Autofill framework password type
    wcag: "1.3.5 Identify Input Purpose"
    platforms: [web, ios, android]
    validation: |
      - Web: autocomplete attribute set correctly
      - iOS: textContentType set to password or newPassword
      - Android: Autofill type set to password
      - Password manager integration works

# Design tokens this component requires (inherited from Input-Text-Base + toggle)
tokens:
  # All tokens inherited from Input-Text-Base
  typography:
    - typography.labelMd
    - typography.labelMdFloat
    - typography.input
    - typography.caption
  color:
    - color.text.muted
    - color.text.default
    - color.primary
    - color.error
    - color.error.strong
    - color.success.strong
    - color.border
    - color.background
  spacing:
    - space.inset.100
    - space.grouped.tight
    - space.grouped.minimal
  motion:
    - motion.floatLabel
    - motion.focusTransition
  border:
    - borderDefault
    - radius150
  accessibility:
    - tapAreaRecommended
    - accessibility.focus.width
    - accessibility.focus.offset
    - accessibility.focus.color
  icon:
    - icon.size100
  blend:
    - blend.focusSaturate
    - blend.disabledDesaturate

# Supported platforms
platforms:
  - web
  - ios
  - android

# Platform-specific implementation notes
platform_notes:
  web:
    element: "<input-text-password>"
    implementation: Web Component wrapping Input-Text-Base
    file: platforms/web/InputTextPassword.web.ts
    toggle: Button with eye/eye-off icon
    autocomplete: autocomplete="current-password" or "new-password"
  ios:
    implementation: SwiftUI View wrapping InputTextBase
    file: platforms/ios/InputTextPassword.ios.swift
    toggle: Button with SF Symbol eye/eye.slash
    autocomplete: UITextContentType.password or .newPassword
  android:
    implementation: Jetpack Compose Composable wrapping InputTextBase
    file: platforms/android/InputTextPassword.android.kt
    toggle: IconButton with visibility icons
    autocomplete: Autofill framework password type

# Inheritance relationship
inheritance:
  parent: Input-Text-Base
  extends:
    - secure input masking
    - password toggle functionality
    - password autocomplete
  dynamic_properties:
    type: toggles between 'password' and 'text'
    autocomplete: 'current-password' or 'new-password'

# Accessibility compliance (inherited + extended)
accessibility:
  wcag_level: AA
  compliance:
    # Inherited from Input-Text-Base
    - "1.4.1 Use of Color - Error/success states use icons, not just color"
    - "1.4.3 Contrast (Minimum) - All text meets 4.5:1 contrast"
    - "1.4.11 Non-text Contrast - Focus ring meets 3:1 contrast"
    - "2.1.1 Keyboard - Fully keyboard accessible including toggle"
    - "2.4.7 Focus Visible - Clear focus indicator"
    - "2.3.3 Animation from Interactions - Respects reduced motion"
    - "3.3.1 Error Identification - Errors clearly identified"
    - "3.3.2 Labels or Instructions - Label always visible"
    - "4.1.2 Name, Role, Value - Proper ARIA attributes"
    # Password-specific
    - "1.3.5 Identify Input Purpose - Password autocomplete enabled"
    - "4.1.2 Name, Role, Value - Toggle button properly labeled"
